<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="utf-8">
      <meta content="width=device-width, initial-scale=1.0" name="viewport">
      <title>Plotting Gallery</title>
      <meta content="" name="description">
      <meta content="" name="keywords">
      <!-- Google Fonts -->
      <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">
      <!-- Vendor CSS Files -->
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
      <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>
      <!-- Template Main CSS File -->
      <link href="assets/css/style.css" rel="stylesheet">
   </head>
   <body>
      <!-- ======= Mobile nav toggle button ======= -->
      <i class="bi bi-list mobile-nav-toggle d-xl-none"></i>
      <!-- ======= Header ======= -->
      <header id="header">
         <div class="d-flex flex-column">
            <div class="profile">
               <img src="https://avatars.githubusercontent.com/u/22362177" alt="" class="img-fluid rounded-circle">
               <h1 class="text-light"><a href="index.html">Plotting Gallery</a></h1>
               <div class="social-links mt-3 text-center">
                  <a href="https://cs.tinyiu.com" class="home"><i class="bx bxs-home-heart"></i></a>
                  <a href="https://github.com/soraxas/plotting-gallery" class="github"><i class="bx bxl-github"></i></a>
                  <!-- <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                     <a href="#" class="instagram"><i class="bx bxl-instagram"></i></a>
                     <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                     <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a> -->
               </div>
            </div>
            <nav id="navbar" class="nav-menu navbar">
               <ul>
                  <!-- <li><a href="#notebook" class="nav-link scrollto"><i class="bx bx-server"></i> <span>Services</span></a></li> -->
                  <div id="sidebar_ipynb">
                  </div>
               </ul>
            </nav>
            <!-- .nav-menu -->
         </div>
      </header>
      <!-- End Header -->
      <!-- ======= Services Section ======= -->
      <section id="notebook" class="services">
         <div class="container">
            <div class="section-title">
               <h2>Jupyter Notebook Showcase</h2>
            </div>
            <p>Notebooks includes <span id="notebook-lists"></span></p>
            <div id="serving-info">
               Click on one of the link in the sidebar to begin rendering.
            </div>
            <br/>
            <div id="notebook-content"></div>
         </div>
      </section>
      <!-- End Services Section -->
      </main><!-- End #main -->
      <!-- ======= Footer ======= -->
      <footer id="footer">
         <div class="container">
            <div>
              @ <a href="https://github.com/soraxas/plotting-gallery" class="github">soraxas/plotting-gallery</a>
            </div>
         </div>
      </footer>
      <!-- End  Footer -->
      <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>
      <!-- Vendor JS Files -->
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
      <!-- Typed text (animated typing effect)-->
      <script type="text/javascript" src="https://unpkg.com/typed.js@~2.0.11"></script>
      <!-- ScrollMonitor (manages events for elements scrolling in and out of view) -->
      <script type="text/javascript" src="https://unpkg.com/scrollmonitor@~1.2.4"></script>
      <!-- Template Main JS File -->
      <script src="assets/js/main.js"></script>
      <script src='assets/nbv.js'></script>
      <script src='assets/render_gh_file.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/marked/0.3.6/marked.min.js'></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/prism.min.js' data-manual></script>
      <script src='https://cdnjs.cloudflare.com/ajax/libs/prism/1.5.1/components/prism-python.min.js' data-manual></script>
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq" crossorigin="anonymous">
      <script src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz" crossorigin="anonymous"></script>
      <script>
         const target_repo = 'soraxas/plotting-gallery'

               function build_sidebar(url_list) {
               const sidebar = document.getElementById('sidebar_ipynb')

               for (let item of url_list) {
                 const url = item.url;

                 // console.log(url)
                 // console.log(notebook_name)

                 const li = document.createElement('li');
                 const a = document.createElement('a');
                 const icon = document.createElement('i');
                 icon.setAttribute('class', "bx bx-file-blank");
                 a.appendChild(icon);
                 li.appendChild(a);
                 a.href = '#notebook'
                 a.setAttribute(
                   'onclick',
                   `render_gh_files('${url}', '${item.path_name}'); return true;`
                 )
                 const span = document.createElement("span");


                 let style_name = item.style_name;
                 // remove underscore _
                 style_name = style_name.replaceAll('_', ' ');
                 // newline
                 style_name = style_name.replace(/([^<])[/]/, '$1/<br/>');
                 // remove file suffix
                 style_name = style_name.replace(/.ipynb/, '');
                 // console.log(style_name);


                 span.innerHTML  = style_name;
                 span.setAttribute("class", "wraplongword");
                 a.appendChild(span);
                 sidebar.appendChild(a);
               }
             }

             const api_url = `https://api.github.com/repos/${target_repo}/git/trees/master?recursive=true`;
             // render_gh_files(api_url);
             fetch(api_url).then(repo_structure_ => {
               repo_structure_.json().then(repo_structure => {
                 let urls = [];
                 let notebook_names = [];
                 for (let i = 0; i < repo_structure["tree"].length; ++i) {
                   const item = repo_structure["tree"][i];
                   if (item["type"] === "blob" && item["path"].endsWith(".ipynb")) {
                     let name = item["path"];

                     // add color
                     name = name.replace(/^([^/]*)?[/](.*)/,
                       '<span style="color: cyan;">$1</span>' +
                       '<span style="color: orange; font-weight: bold;">/</span>' +
                       '<span >$2</span>'
                       );
                     name = `<code>${name}</code>`

                     const ele = {
                       "url": item["url"],
                       "path_name": item["path"],
                       "style_name": name,
                     }

                     urls.push(ele);
                     notebook_names.push(ele.style_name);
                   }
                 }
                 // document.getElementById("notebook-lists").setAttribute("data-typed-items", notebook_names.join(", "));

                 const typed = new Typed('#notebook-lists', {
                 /**
                  * @property {array} strings strings to be typed
                  * @property {string} stringsElement ID of element containing string children
                  */
                 strings: notebook_names,
                 stringsElement: null,
                 typeSpeed: 25,
                 shuffle: true,
                 loop: true,
               });

                 build_sidebar(urls);
               })
             }) // TODO: this could fail on API limits

             if (!window.marked || !window.Prism || !window.katex) {
               throw new Error(
                 'expecting libraries marked.js, Prism.js and KaTeX to be present'
               )
             }
             const notebook_viewer = nbv_constructor(document, {
               katex: window.katex,
               prism: window.Prism,
               marked: window.marked
             })
      </script>
   </body>
</html>